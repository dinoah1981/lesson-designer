---
phase: 02-material-quality-formatting
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/skills/lesson-designer/scripts/generate_worksheet.py
autonomous: true

must_haves:
  truths:
    - "Worksheets have double-spaced lines for student writing"
    - "Answer spaces provide adequate room (5+ underscore lines per question)"
    - "Line spacing scales with font size (multiplier-based, not fixed Pt)"
  artifacts:
    - path: ".claude/skills/lesson-designer/scripts/generate_worksheet.py"
      provides: "Enhanced worksheet generation with proper line spacing"
      contains: "line_spacing = 2.0"
  key_links:
    - from: "generate_worksheet.py"
      to: "lesson.json"
      via: "load_lesson_design function"
      pattern: "line_spacing.*2\\.0"
---

<objective>
Enhance worksheet generation to provide proper double-spacing and adequate writing space for student responses.

Purpose: Students need physical room to write answers. Current worksheets use 1.5 spacing which is too cramped for handwritten responses. This directly addresses requirement MATL-02.

Output: Updated generate_worksheet.py that produces worksheets with double-spaced answer lines and proper margins for student writing.
</objective>

<execution_context>
@C:\Users\david\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\david\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-material-quality-formatting/02-RESEARCH.md

# Existing script to modify
@.claude/skills/lesson-designer/scripts/generate_worksheet.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update line spacing to double-spaced</name>
  <files>.claude/skills/lesson-designer/scripts/generate_worksheet.py</files>
  <action>
Modify generate_worksheet.py to use double-spacing for all student answer areas:

1. At the top of file, add import if not present:
   ```python
   from docx.enum.text import WD_LINE_SPACING
   ```

2. Update add_answer_lines() function to use double-spacing:
   ```python
   def add_answer_lines(doc: Document, num_lines: int = 3, prefix: str = "") -> None:
       """Add underscore answer lines with double-spacing for student responses."""
       for i in range(num_lines):
           line_text = prefix if i == 0 and prefix else ""
           p = doc.add_paragraph(line_text + "_" * 70)
           p.paragraph_format.line_spacing = 2.0  # Double-spaced
           p.paragraph_format.space_before = Pt(6)
           p.paragraph_format.space_after = Pt(6)
           for run in p.runs:
               run.font.size = Pt(11)  # Slightly larger for readability
   ```

3. Update add_numbered_questions() to increase answer space:
   - Change default num_lines from 2 to 3
   - Apply double-spacing to question text as well

4. Update generate_worksheet_from_lesson() to:
   - Increase default answer lines for analysis/knowledge_utilization from 4 to 5
   - Add double-spacing to discussion notes sections

5. Do NOT change margins (keep narrow for compactness) - double-spacing provides the writing room.

Important: Use float multiplier (2.0) not Pt() for line_spacing. This ensures spacing scales properly with different font sizes per RESEARCH.md guidance.
  </action>
  <verify>
Run validation on existing test fixture:
```bash
cd "C:\Users\david\OneDrive\Desktop\lesson-designer"
python .claude/skills/lesson-designer/scripts/generate_worksheet.py .claude/skills/lesson-designer/tests/fixtures/sample_lesson.json test_double_spaced.docx
```
Open test_double_spaced.docx and verify answer lines are double-spaced.
  </verify>
  <done>
- generate_worksheet.py uses line_spacing = 2.0 for answer areas
- Generated worksheets have visible double-spacing between answer lines
- No regressions in existing functionality
  </done>
</task>

<task type="auto">
  <name>Task 2: Add writing space configuration</name>
  <files>.claude/skills/lesson-designer/scripts/generate_worksheet.py</files>
  <action>
Add configuration for different writing space amounts based on activity type:

1. Add a WRITING_SPACE_CONFIG dictionary near the top of file:
   ```python
   # Lines of answer space by activity type
   WRITING_SPACE_CONFIG = {
       'retrieval': 2,           # Quick recall, less space needed
       'comprehension': 3,       # Explanations need moderate space
       'analysis': 5,            # Detailed responses need more space
       'knowledge_utilization': 6,  # Complex responses need most space
       'default': 3
   }
   ```

2. Update generate_worksheet_from_lesson() to use this config:
   - Get marzano_level from activity
   - Look up line count from WRITING_SPACE_CONFIG
   - Pass to add_answer_lines()

3. Update add_exit_ticket() to provide adequate answer space:
   - Change from 2 to 4 lines per exit ticket question
   - These are often the most important responses

4. Update validate_output() to check for double-spacing:
   - Add check that answer paragraphs have line_spacing >= 1.5
   - Warn if document seems to lack adequate answer space
  </action>
  <verify>
Generate worksheet from sample lesson and verify:
```bash
python .claude/skills/lesson-designer/scripts/generate_worksheet.py .claude/skills/lesson-designer/tests/fixtures/sample_lesson.json test_config_spacing.docx
python -c "from docx import Document; d=Document('test_config_spacing.docx'); print('Tables:', len(d.tables)); print('Paragraphs:', len([p for p in d.paragraphs if '_' in p.text]))"
```
Should show underscore paragraphs exist for answer lines.
  </verify>
  <done>
- WRITING_SPACE_CONFIG controls lines per Marzano level
- Higher-order activities get more writing space
- Exit ticket has 4 lines per question
- Validation checks for adequate spacing
  </done>
</task>

</tasks>

<verification>
1. Generate worksheet from test fixture - completes without error
2. Open generated .docx - answer lines are visibly double-spaced
3. Analysis activities have 5+ answer lines
4. Exit ticket questions have 4 answer lines
5. Line spacing uses float multiplier (2.0), not fixed Pt values
</verification>

<success_criteria>
- MATL-02 satisfied: Worksheets use double-spaced lines with adequate space for student writing
- Answer space scales with cognitive complexity (more space for analysis than retrieval)
- No regressions in existing worksheet generation
- Validation script can detect inadequate spacing
</success_criteria>

<output>
After completion, create `.planning/phases/02-material-quality-formatting/02-01-SUMMARY.md`
</output>
