---
phase: 01-core-lesson-generation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - .claude/skills/lesson-designer/SKILL.md
  - .claude/skills/lesson-designer/scripts/parse_competency.py
autonomous: true

must_haves:
  truths:
    - "Teacher can input competency with lesson count and duration"
    - "Tool decomposes competency into skills and factual knowledge"
    - "Teacher can classify knowledge items and set proficiency target"
    - "Input is validated and saved as structured JSON"
  artifacts:
    - path: ".claude/skills/lesson-designer/SKILL.md"
      provides: "Updated Stage 1-2 and Stage 4 instructions"
      contains: "Stage 1: Gather competency requirements"
    - path: ".claude/skills/lesson-designer/scripts/parse_competency.py"
      provides: "Input parsing and competency decomposition"
      exports: ["parse_input", "decompose_competency", "save_session_state"]
  key_links:
    - from: "SKILL.md Stage 1"
      to: "parse_competency.py"
      via: "script execution"
      pattern: "python.*parse_competency"
---

<objective>
Implement teacher input handling, competency decomposition, and knowledge classification workflow.

Purpose: Enable teachers to specify what they want to teach and how, then decompose the competency into teachable components. This is the entry point for the entire lesson design workflow.

Output: Updated SKILL.md with complete Stage 1, 2, and 4 instructions plus parse_competency.py script for input validation and decomposition.
</objective>

<execution_context>
@C:\Users\david\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\david\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-core-lesson-generation/01-RESEARCH.md
@.planning/phases/01-core-lesson-generation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Stage 1 - Competency input gathering</name>
  <files>
    .claude/skills/lesson-designer/SKILL.md
  </files>
  <action>
Update SKILL.md to add complete Stage 1 instructions.

**Stage 1: Gather competency requirements**

Add detailed instructions for Claude to:

1. Ask the teacher these questions:
   - "What competency do you want students to master?" (the skill they'll demonstrate)
   - "What grade level are the students?"
   - "How many lessons do you want to dedicate to this competency?" (default: 1)
   - "How long is each lesson period?" (50 min, 60 min, 90 min, etc.)
   - "Are there any constraints I should know about?" (available materials, time of year, etc.)

2. Explain that the tool handles single competencies (series of competencies is Phase 5):
   "This tool currently designs lessons for one competency at a time. For multi-lesson sequences across competencies, that's coming in a future update."

3. Validate inputs:
   - Competency must be stated as what students will DO (skill-focused, not topic-focused)
   - Good: "Students will analyze primary sources to evaluate historical claims"
   - Bad: "The Civil War" (topic, not competency)
   - If topic given, help teacher reframe as competency

4. Create session directory and save input:
   ```
   .lesson-designer/sessions/{uuid}/
   └── 01_input.json
   ```

Input JSON schema:
```json
{
  "session_id": "uuid",
  "competency": "string (skill statement)",
  "grade_level": "string (e.g., '7th grade', 'AP', 'College')",
  "lesson_count": "integer (1+)",
  "lesson_duration": "integer (minutes)",
  "constraints": "string or null",
  "created_at": "ISO timestamp"
}
```

Include example conversation showing how Stage 1 flows.

Cover requirement COMP-01 (single vs series - acknowledge series is future) and COMP-02 (lesson count and duration).
  </action>
  <verify>
SKILL.md contains "Stage 1: Gather competency requirements"
Stage 1 includes all 5 input questions
Stage 1 includes input validation guidance (skill vs topic)
Stage 1 includes JSON schema for 01_input.json
  </verify>
  <done>
Stage 1 enables teacher to specify competency with lesson count and duration
Input is validated and saved as structured JSON in session directory
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement Stage 2 - Competency decomposition</name>
  <files>
    .claude/skills/lesson-designer/SKILL.md
    .claude/skills/lesson-designer/scripts/parse_competency.py
  </files>
  <action>
Update SKILL.md to add complete Stage 2 instructions and create parse_competency.py.

**Stage 2: Decompose into skills and knowledge**

Add instructions for Claude to:

1. Load input from `01_input.json`

2. Decompose the competency into:
   - **The skill** - What students will DO (verb + object)
   - **Required factual knowledge** - What students need to KNOW to perform the skill

   Example decomposition:
   ```
   Competency: "Students will analyze primary sources to evaluate historical claims"

   Skill: Evaluate historical claims using primary source evidence

   Required Knowledge:
   1. What primary sources are (definition, types)
   2. How to identify bias in sources
   3. What constitutes evidence vs. opinion
   4. Historical context of the period being studied
   5. How to cite sources properly
   ```

3. Present decomposition to teacher for review:
   "I've broken down the competency like this. Does this look right?"

4. Save decomposition to `02_competency_breakdown.json`:
```json
{
  "skill": {
    "verb": "evaluate",
    "object": "historical claims",
    "full_statement": "Evaluate historical claims using primary source evidence"
  },
  "required_knowledge": [
    {
      "id": "K1",
      "item": "What primary sources are (definition, types)",
      "classification": null
    },
    ...
  ]
}
```

**Create parse_competency.py:**
Python script with functions:
- `generate_session_id()` - Creates UUID for session
- `create_session_directory(session_id)` - Creates `.lesson-designer/sessions/{id}/`
- `save_input(session_id, input_data)` - Saves 01_input.json
- `load_input(session_id)` - Loads 01_input.json
- `save_breakdown(session_id, breakdown_data)` - Saves 02_competency_breakdown.json
- `load_breakdown(session_id)` - Loads 02_competency_breakdown.json

Use absolute paths throughout (Claude environment resets working directory between bash calls).

Cover requirement COMP-03 (decompose into skill + knowledge).
  </action>
  <verify>
SKILL.md contains "Stage 2: Decompose into skills and knowledge"
Stage 2 includes decomposition guidance with example
Stage 2 includes JSON schema for 02_competency_breakdown.json
parse_competency.py exists with all required functions
parse_competency.py uses absolute paths
  </verify>
  <done>
Stage 2 decomposes competency into skill and required knowledge
Decomposition is saved as structured JSON
parse_competency.py provides utility functions for session management
  </done>
</task>

<task type="auto">
  <name>Task 3: Implement Stage 4 - Knowledge classification and proficiency targets</name>
  <files>
    .claude/skills/lesson-designer/SKILL.md
  </files>
  <action>
Update SKILL.md to add complete Stage 4 instructions.

**Stage 4: Teacher classification and proficiency targets**

Note: Stage 3 (lesson design) and Stage 3b (validation) are in Plan 03. This is Stage 4 in the workflow because classification happens AFTER initial decomposition but BEFORE lesson design.

CORRECTION: Rename this to happen between Stage 2 and Stage 3. Update SKILL.md workflow to:
- Stage 1: Gather competency requirements
- Stage 2: Decompose into skills and knowledge
- Stage 2b: Teacher classification and proficiency targets (THIS TASK)
- Stage 3: Design lesson with Marzano taxonomy
- Stage 3b: Validate cognitive rigor
- Stage 5: Generate materials
- Stage 6: Validate outputs
- Stage 7: Present to teacher

**Stage 2b: Teacher classification and proficiency targets**

Add instructions for Claude to:

1. Present each knowledge item and ask teacher to classify:
   ```
   For each knowledge item, tell me:
   - "Needs teaching" - Students don't know this yet
   - "Already assumed" - Students should already know this

   K1: What primary sources are (definition, types)
   Classification? [needs teaching / already assumed]

   K2: How to identify bias in sources
   Classification? [needs teaching / already assumed]
   ...
   ```

2. For items marked "already assumed", note that the lesson will include brief retrieval practice but not direct instruction.

3. Ask about target proficiency level:
   ```
   After this lesson/sequence, what proficiency level should students reach?

   - Novice: Can perform skill with significant support/scaffolding
   - Developing: Can perform skill with some support
   - Proficient: Can perform skill independently
   - Advanced: Can perform skill and teach/extend it
   ```

4. Update `02_competency_breakdown.json` with classifications:
```json
{
  "skill": {...},
  "required_knowledge": [
    {
      "id": "K1",
      "item": "What primary sources are",
      "classification": "needs_teaching"
    },
    {
      "id": "K2",
      "item": "How to identify bias",
      "classification": "already_assumed"
    }
  ],
  "target_proficiency": "proficient"
}
```

Cover requirements COMP-04 (classify knowledge items) and COMP-05 (target proficiency level).
  </action>
  <verify>
SKILL.md contains "Stage 2b: Teacher classification and proficiency targets"
Stage 2b includes classification options (needs teaching vs already assumed)
Stage 2b includes proficiency level options (novice through advanced)
Updated JSON schema shows classification and target_proficiency fields
  </verify>
  <done>
Teacher can classify each knowledge item as needs teaching or already assumed
Teacher can set target proficiency level (novice/developing/proficient/advanced)
Classifications are saved in competency breakdown JSON
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. SKILL.md workflow is updated to include:
   - Stage 1: Gather competency requirements (complete)
   - Stage 2: Decompose into skills and knowledge (complete)
   - Stage 2b: Teacher classification and proficiency targets (complete)
   - Stage 3: Design lesson with Marzano taxonomy (placeholder)
   - Stage 3b: Validate cognitive rigor (placeholder)
   - Stage 5: Generate materials (placeholder)
   - Stage 6: Validate outputs (placeholder)
   - Stage 7: Present to teacher (placeholder)

2. parse_competency.py can be imported and functions work:
```python
import sys
sys.path.insert(0, '.claude/skills/lesson-designer/scripts')
from parse_competency import generate_session_id, create_session_directory

session_id = generate_session_id()
create_session_directory(session_id)
# Should create .lesson-designer/sessions/{session_id}/ directory
```

3. Coverage of requirements:
   - COMP-01: Single competency supported, series acknowledged as future
   - COMP-02: Lesson count and duration captured
   - COMP-03: Competency decomposed into skill + knowledge
   - COMP-04: Knowledge classification (needs teaching / already assumed)
   - COMP-05: Target proficiency level captured
</verification>

<success_criteria>
- Stage 1 captures all required inputs (competency, grade, lesson count, duration, constraints)
- Stage 1 validates competency is skill-focused not topic-focused
- Stage 2 decomposes competency into skill statement + required knowledge list
- Stage 2b allows teacher to classify each knowledge item
- Stage 2b captures target proficiency level
- All data is saved as JSON in session directory
- parse_competency.py provides working utility functions
- All COMP-* requirements (01-05) are addressed
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-lesson-generation/01-02-SUMMARY.md`
</output>
